import { Component, Input } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule } from '@angular/forms';
import { GoodImplementationService } from '../../services/good-implementation.service';
import { BadImplementationService } from '../../services/bad-implementation.service';

@Component({
  selector: 'app-xss',
  imports: [CommonModule, FormsModule],
  templateUrl: './xss.component.html',
  styleUrl: './xss.component.css',
})
export class XSSComponent {
  @Input() isGoodImplementation: boolean = false
  showModal: boolean = false
  copiedText: string = ''
  
  textInputGood: string = ''
  textInputBad: string = ''

  constructor(
    private goodService: GoodImplementationService,
    private badService: BadImplementationService
  ) {}

  onGoodSubmit() {
    this.goodService.saveXSSValue(this.textInputGood)
  }

  onBadSubmit() {

  }

  clearInput() {
    if (this.isGoodImplementation) {
      this.textInputGood = '' 
    } else {
      this.textInputBad = ''
    }
  }

  exploitSteps = {
    step1: "",
    step2: "",
    step3: "",
    step4: ""
  }

  toggleModal() {
    this.showModal = !this.showModal
    if (!this.showModal) {
      this.copiedText = ''
    }
  }

  copyToClipboard(text: string, event?: Event) {
    if (event) {
      event.stopPropagation()
    }
    this.copiedText = text
    navigator.clipboard.writeText(text).catch(() => {
      this.copiedText = ''
    });
  }
}
