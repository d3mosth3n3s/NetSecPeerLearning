<div class="container-fluid h-100">
  <div class="row h-100">
    <!-- Vulnerability Component - 2/3 of screen -->
    <div class="col-lg-8" 
         [style.background]="isGoodImplementation ? 'linear-gradient(135deg, #e0f2fe 0%, #dcfce7 100%)' : 'linear-gradient(135deg, #fecaca 0%, #fef9c3 100%)'">
      @if (vulnerability$ | async; as vulnerability) {
        <div class="p-4 h-100">
          <div class="d-flex align-items-center justify-content-between mb-4">
            <div class="d-flex align-items-center">
              <a routerLink="/" class="btn btn-link text-dark p-0 me-3 text-decoration-none" style="font-size: 1.8rem; line-height: 1;">
                <i class="bi bi-arrow-left-circle-fill"></i>
              </a>
              <h3 class="mb-0">{{ vulnerability.name }}</h3>
              <a [href]="vulnerability.link" target="_blank" rel="noopener noreferrer" 
                 class="btn btn-link text-dark p-0 ms-2 text-decoration-none" 
                 title="Go to CWE documentation" style="font-size: 1rem; line-height: 1;">
                <i class="bi bi-box-arrow-up-right"></i>
              </a>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="implementationToggle" 
                     [checked]="isGoodImplementation" (change)="toggleImplementation()" 
                     style="width: 3em; height: 1.5em; cursor: pointer;">
              <label class="form-check-label ms-2" for="implementationToggle" style="cursor: pointer;">
                {{ isGoodImplementation ? 'Good' : 'Bad' }} Implementation
              </label>
            </div>
          </div>
          <div class="d-flex align-items-center justify-content-center" style="height: calc(100% - 70px);">
            @switch (vulnerability.id) {
              @case ('template') {
                <app-template [isGoodImplementation]="isGoodImplementation"></app-template>
              }
              @case ('SQL Inject') {
                <app-template [isGoodImplementation]="isGoodImplementation"></app-template>
              }
              <!-- @case ('Improper-Neutralization-of-Special-Elements-used-in-an-SQL-Command') {
                <app-sql-injection></app-sql-injection>
              } -->
              <!-- @case ('Improper-Neutralization-of-Input-During-Web-Page-Generation') {
                <app-xss></app-xss>
              } -->
              @default {
                <div class="alert alert-warning">Component not yet implemented for this vulnerability.</div>
              }
            }
          </div>
        </div>
      }
    </div>
    
    <!-- Playground - 1/3 of screen -->
    <div class="col-lg-4 border-start">
      @if (vulnerability$ | async; as vulnerability) {
        <app-playground [vulnerability]="vulnerability"></app-playground>
      }
    </div>
  </div>
</div>
